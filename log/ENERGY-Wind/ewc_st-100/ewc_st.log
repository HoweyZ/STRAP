2025-04-27 18:30:19,367 - logger name:log/ENERGY-Wind/ewc_st-100/ewc_st.log
2025-04-27 18:30:19,367 - params : {'conf': 'conf/ENERGY-Wind/ewc.json', 'seed': 100, 'paral': 0, 'backbone_type': 'stgnn', 'gpuid': 2, 'logname': 'ewc_st', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/haoyu.zhang/MoE_GNN/new/code/log/AIR/stlora_T-24/2016/21.3875.pkl', 'device': device(type='cuda', index=2), 'methods': {'PECPM': <class 'src.model.model.PECPM_Model'>, 'ST-Adapter': <class 'src.model.model.STAdapter_Model'>, 'GraphPro': <class 'src.model.model.GraphPro_Model'>, 'RAGraph': <class 'src.model.model.RAGraph_Model'>, 'STGNN_Model': <class 'src.model.model.STGNN_Model'>, 'ASTGNN_Model': <class 'src.model.model.ASTGNN_Model'>, 'DCRNN_Model': <class 'src.model.model.DCRNN_Model'>, 'TGCN_Model': <class 'src.model.model.TGCN_Model'>, 'STLoRA': <class 'src.model.model.STLora_Model'>, 'RAP': <class 'src.model.model.RAP_Model'>, 'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>}, 'begin_year': 0, 'end_year': 3, 'dropout': 0.0, 'lr': 0.03, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': 'data/ENERGY-Wind/RawData/', 'save_data_path': 'data/ENERGY-Wind/FastData/', 'graph_path': 'data/ENERGY-Wind/graph/', 'model_path': 'log/ENERGY-Wind/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': False, 'replay_strategy': 'inforeplay', 'path': 'log/ENERGY-Wind/ewc_st-100', 'logger': <Logger utils.initialize (INFO)>}
2025-04-27 18:30:19,380 - [*] Year 0 load from data/ENERGY-Wind/FastData/0.npz
2025-04-27 18:30:19,848 - [*] Year 0 Dataset load!
2025-04-27 18:30:19,850 - [*] Year 0 Training start
2025-04-27 18:30:20,126 - node number torch.Size([13184, 12])
2025-04-27 18:30:21,416 - epoch:0, training loss:225.4257 validation loss:2.0238
2025-04-27 18:30:22,809 - epoch:1, training loss:4.4564 validation loss:3.2258
2025-04-27 18:30:24,235 - epoch:2, training loss:2.6371 validation loss:3.2146
2025-04-27 18:30:25,658 - epoch:3, training loss:2.3228 validation loss:3.4737
2025-04-27 18:30:27,086 - epoch:4, training loss:2.2574 validation loss:2.9943
2025-04-27 18:30:28,485 - epoch:5, training loss:2.2159 validation loss:2.8308
2025-04-27 18:30:29,975 - epoch:6, training loss:2.1844 validation loss:3.2155
2025-04-27 18:30:30,646 - [*] loss:19.0199
2025-04-27 18:30:30,654 - [*] year 0, testing
2025-04-27 18:30:30,715 - T:3	MAE	5.1983	RMSE	5.4105	MAPE	13.6366
2025-04-27 18:30:30,838 - T:6	MAE	3.9582	RMSE	4.4382	MAPE	10.4497
2025-04-27 18:30:31,229 - T:12	MAE	3.8678	RMSE	4.4074	MAPE	10.1850
2025-04-27 18:30:31,229 - T:Avg	MAE	4.3847	RMSE	4.7815	MAPE	11.5351
2025-04-27 18:30:31,229 - Finished optimization, total time:6.13 s, best model:log/ENERGY-Wind/ewc_st-100/0/2.0238.pkl
2025-04-27 18:30:31,237 - [*] Year 1 load from data/ENERGY-Wind/FastData/1.npz
2025-04-27 18:30:31,241 - [*] load from log/ENERGY-Wind/ewc_st-100/0/2.0238.pkl
2025-04-27 18:30:31,288 - number of increase nodes:10, nodes after 2 hop:torch.Size([59]), total nodes this year 113
2025-04-27 18:30:31,507 - [*] Year 1 Dataset load!
2025-04-27 18:30:31,508 - [*] load from log/ENERGY-Wind/ewc_st-100/0/2.0238.pkl
2025-04-27 18:30:31,513 - [*] EWC! lambda 0.000100
2025-04-27 18:30:32,639 - [*] Year 1 Training start
2025-04-27 18:30:33,204 - node number torch.Size([7552, 12])
2025-04-27 18:30:34,835 - epoch:0, training loss:24.4217 validation loss:1.3352
2025-04-27 18:30:36,871 - epoch:1, training loss:2.5254 validation loss:1.1688
2025-04-27 18:30:43,956 - epoch:2, training loss:1.8719 validation loss:1.0735
2025-04-27 18:30:46,049 - epoch:3, training loss:1.8003 validation loss:1.1368
2025-04-27 18:30:48,098 - epoch:4, training loss:1.7715 validation loss:1.1709
2025-04-27 18:30:50,329 - epoch:5, training loss:1.7270 validation loss:1.1115
2025-04-27 18:30:52,421 - epoch:6, training loss:1.7179 validation loss:1.0636
2025-04-27 18:30:54,468 - epoch:7, training loss:1.6518 validation loss:1.1209
2025-04-27 18:30:56,507 - epoch:8, training loss:1.6646 validation loss:0.9136
2025-04-27 18:30:58,540 - epoch:9, training loss:1.6376 validation loss:0.9305
2025-04-27 18:31:00,640 - epoch:10, training loss:1.5917 validation loss:1.0975
2025-04-27 18:31:02,692 - epoch:11, training loss:1.6020 validation loss:0.9544
2025-04-27 18:31:04,726 - epoch:12, training loss:1.5571 validation loss:1.0353
2025-04-27 18:31:06,781 - epoch:13, training loss:1.5564 validation loss:0.9336
2025-04-27 18:31:08,854 - epoch:14, training loss:1.5533 validation loss:1.0879
2025-04-27 18:31:09,585 - [*] loss:6.1147
2025-04-27 18:31:09,598 - [*] year 1, testing
2025-04-27 18:31:09,654 - T:3	MAE	2.1165	RMSE	2.2483	MAPE	5.9554
2025-04-27 18:31:09,745 - T:6	MAE	2.1135	RMSE	2.2949	MAPE	5.9831
2025-04-27 18:31:10,027 - T:12	MAE	2.1799	RMSE	2.4661	MAPE	6.2235
2025-04-27 18:31:10,027 - T:Avg	MAE	2.1325	RMSE	2.3243	MAPE	6.0383
2025-04-27 18:31:10,027 - Finished optimization, total time:25.20 s, best model:log/ENERGY-Wind/ewc_st-100/1/0.9136.pkl
2025-04-27 18:31:10,036 - [*] Year 2 load from data/ENERGY-Wind/FastData/2.npz
2025-04-27 18:31:10,040 - [*] load from log/ENERGY-Wind/ewc_st-100/1/0.9136.pkl
2025-04-27 18:31:10,086 - number of increase nodes:9, nodes after 2 hop:torch.Size([52]), total nodes this year 122
2025-04-27 18:31:10,299 - [*] Year 2 Dataset load!
2025-04-27 18:31:10,300 - [*] load from log/ENERGY-Wind/ewc_st-100/1/0.9136.pkl
2025-04-27 18:31:10,305 - [*] EWC! lambda 0.000100
2025-04-27 18:31:11,531 - [*] Year 2 Training start
2025-04-27 18:31:12,170 - node number torch.Size([6656, 12])
2025-04-27 18:31:13,681 - epoch:0, training loss:11.6381 validation loss:7.6154
2025-04-27 18:31:15,855 - epoch:1, training loss:2.1873 validation loss:7.7641
2025-04-27 18:31:17,951 - epoch:2, training loss:1.9222 validation loss:7.6628
2025-04-27 18:31:20,049 - epoch:3, training loss:1.8662 validation loss:7.5857
2025-04-27 18:31:22,161 - epoch:4, training loss:1.8010 validation loss:7.2015
2025-04-27 18:31:24,255 - epoch:5, training loss:1.9621 validation loss:7.1811
2025-04-27 18:31:26,336 - epoch:6, training loss:1.9042 validation loss:8.0896
2025-04-27 18:31:28,447 - epoch:7, training loss:1.8416 validation loss:7.5287
2025-04-27 18:31:30,572 - epoch:8, training loss:1.8020 validation loss:7.9939
2025-04-27 18:31:32,673 - epoch:9, training loss:1.7699 validation loss:7.8637
2025-04-27 18:31:34,844 - epoch:10, training loss:1.8245 validation loss:8.1151
2025-04-27 18:31:36,991 - epoch:11, training loss:1.7830 validation loss:7.7546
2025-04-27 18:31:37,737 - [*] loss:57.9808
2025-04-27 18:31:37,744 - [*] year 2, testing
2025-04-27 18:31:37,806 - T:3	MAE	7.7314	RMSE	7.7942	MAPE	34.5244
2025-04-27 18:31:37,905 - T:6	MAE	7.6048	RMSE	7.6884	MAPE	34.0488
2025-04-27 18:31:38,199 - T:12	MAE	7.4944	RMSE	7.6289	MAPE	33.7352
2025-04-27 18:31:38,199 - T:Avg	MAE	7.6237	RMSE	7.7134	MAPE	34.1498
2025-04-27 18:31:38,202 - Finished optimization, total time:16.48 s, best model:log/ENERGY-Wind/ewc_st-100/2/7.1811.pkl
2025-04-27 18:31:38,212 - [*] Year 3 load from data/ENERGY-Wind/FastData/3.npz
2025-04-27 18:31:38,216 - [*] load from log/ENERGY-Wind/ewc_st-100/2/7.1811.pkl
2025-04-27 18:31:38,267 - number of increase nodes:12, nodes after 2 hop:torch.Size([83]), total nodes this year 134
2025-04-27 18:31:38,514 - [*] Year 3 Dataset load!
2025-04-27 18:31:38,515 - [*] load from log/ENERGY-Wind/ewc_st-100/2/7.1811.pkl
2025-04-27 18:31:38,520 - [*] EWC! lambda 0.000100
2025-04-27 18:31:39,717 - [*] Year 3 Training start
2025-04-27 18:31:40,330 - node number torch.Size([10624, 12])
2025-04-27 18:31:41,899 - epoch:0, training loss:21.6432 validation loss:6.4240
2025-04-27 18:31:44,090 - epoch:1, training loss:3.6746 validation loss:6.2600
2025-04-27 18:31:46,231 - epoch:2, training loss:2.7409 validation loss:6.1216
2025-04-27 18:31:48,366 - epoch:3, training loss:2.5202 validation loss:6.1704
2025-04-27 18:31:50,525 - epoch:4, training loss:2.4367 validation loss:5.9844
2025-04-27 18:31:52,698 - epoch:5, training loss:2.3707 validation loss:6.1011
2025-04-27 18:31:54,847 - epoch:6, training loss:2.3350 validation loss:6.0477
2025-04-27 18:31:56,981 - epoch:7, training loss:2.3238 validation loss:6.1205
2025-04-27 18:31:59,196 - epoch:8, training loss:2.2802 validation loss:6.2082
2025-04-27 18:32:01,307 - epoch:9, training loss:2.3001 validation loss:5.9800
2025-04-27 18:32:03,443 - epoch:10, training loss:2.2705 validation loss:6.3855
2025-04-27 18:32:05,579 - epoch:11, training loss:2.2730 validation loss:6.2815
2025-04-27 18:32:07,657 - epoch:12, training loss:2.2364 validation loss:6.4168
2025-04-27 18:32:09,782 - epoch:13, training loss:2.2367 validation loss:6.5209
2025-04-27 18:32:11,909 - epoch:14, training loss:2.2084 validation loss:6.5946
2025-04-27 18:32:14,069 - epoch:15, training loss:2.2263 validation loss:6.6830
2025-04-27 18:32:14,854 - [*] loss:56.4168
2025-04-27 18:32:14,865 - [*] year 3, testing
2025-04-27 18:32:14,936 - T:3	MAE	7.1090	RMSE	7.3276	MAPE	149.9853
2025-04-27 18:32:15,046 - T:6	MAE	7.1137	RMSE	7.4005	MAPE	152.4082
2025-04-27 18:32:15,376 - T:12	MAE	7.1375	RMSE	7.5610	MAPE	158.4329
2025-04-27 18:32:15,376 - T:Avg	MAE	7.1181	RMSE	7.4175	MAPE	153.1645
2025-04-27 18:32:15,379 - Finished optimization, total time:22.07 s, best model:log/ENERGY-Wind/ewc_st-100/3/5.98.pkl
2025-04-27 18:32:15,380 - 


2025-04-27 18:32:15,381 - 3   	 MAE	      5.20	      2.12	      7.73	      7.11		    5.54
2025-04-27 18:32:15,381 - 3   	RMSE	      5.41	      2.25	      7.79	      7.33		    5.70
2025-04-27 18:32:15,381 - 3   	MAPE	     13.64	      5.96	     34.52	    149.99		   51.03
2025-04-27 18:32:15,381 - 6   	 MAE	      3.96	      2.11	      7.60	      7.11		    5.20
2025-04-27 18:32:15,381 - 6   	RMSE	      4.44	      2.29	      7.69	      7.40		    5.46
2025-04-27 18:32:15,381 - 6   	MAPE	     10.45	      5.98	     34.05	    152.41		   50.72
2025-04-27 18:32:15,381 - 12  	 MAE	      3.87	      2.18	      7.49	      7.14		    5.17
2025-04-27 18:32:15,381 - 12  	RMSE	      4.41	      2.47	      7.63	      7.56		    5.52
2025-04-27 18:32:15,381 - 12  	MAPE	     10.19	      6.22	     33.74	    158.43		   52.14
2025-04-27 18:32:15,381 - Avg 	 MAE	      4.38	      2.13	      7.62	      7.12		    5.31
2025-04-27 18:32:15,381 - Avg 	RMSE	      4.78	      2.32	      7.71	      7.42		    5.56
2025-04-27 18:32:15,381 - Avg 	MAPE	     11.54	      6.04	     34.15	    153.16		   51.22
2025-04-27 18:32:15,381 - year	0   	total_time	    6.1297	average_time	    0.8757	epoch	7
2025-04-27 18:32:15,381 - year	1   	total_time	   25.1952	average_time	    1.6797	epoch	15
2025-04-27 18:32:15,381 - year	2   	total_time	   16.4840	average_time	    1.3737	epoch	12
2025-04-27 18:32:15,381 - year	3   	total_time	   22.0685	average_time	    1.3793	epoch	16
2025-04-27 18:32:15,381 - total time: 69.8774
