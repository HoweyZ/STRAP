2025-04-27 20:38:01,699 - logger name:log/ENERGY-Wind/pecpm_st-100/pecpm_st.log
2025-04-27 20:38:01,700 - params : {'conf': 'conf/ENERGY-Wind/pecpm.json', 'seed': 100, 'paral': 0, 'backbone_type': 'stgnn', 'gpuid': 2, 'logname': 'pecpm_st', 'method': 'PECPM', 'load_first_year': 0, 'first_year_model_path': '/home/haoyu.zhang/MoE_GNN/new/code/log/AIR/stlora_T-24/2016/21.3875.pkl', 'device': device(type='cuda', index=2), 'methods': {'PECPM': <class 'src.model.model.PECPM_Model'>, 'ST-Adapter': <class 'src.model.model.STAdapter_Model'>, 'GraphPro': <class 'src.model.model.GraphPro_Model'>, 'RAGraph': <class 'src.model.model.RAGraph_Model'>, 'STGNN_Model': <class 'src.model.model.STGNN_Model'>, 'ASTGNN_Model': <class 'src.model.model.ASTGNN_Model'>, 'DCRNN_Model': <class 'src.model.model.DCRNN_Model'>, 'TGCN_Model': <class 'src.model.model.TGCN_Model'>, 'STLoRA': <class 'src.model.model.STLora_Model'>, 'RAP': <class 'src.model.model.RAP_Model'>, 'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>}, 'begin_year': 0, 'end_year': 3, 'year': 0, 'dropout': 0.0, 'lr': 0.03, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': 'data/ENERGY-Wind/RawData/', 'save_data_path': 'data/ENERGY-Wind/FastData/', 'graph_path': 'data/ENERGY-Wind/graph/', 'model_path': 'log/ENERGY-Wind/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'retrain', 'detect': False, 'ewc': False, 'replay': False, 'attention_weight': {'0': 5, '1': 5, '2': 5, '3': 5}, 'last_clusterc': None, 'cluster_num': 3, 'pattern_matching': True, 'max_patterns': 1000, 'path': 'log/ENERGY-Wind/pecpm_st-100', 'logger': <Logger utils.initialize (INFO)>}
2025-04-27 20:38:01,715 - [*] Year 0 load from data/ENERGY-Wind/FastData/0.npz
2025-04-27 20:38:02,192 - [*] Year 0 Dataset load!
2025-04-27 20:38:02,194 - PECPM initialized with backbone stgnn
2025-04-27 20:38:02,195 - [*] Year 0 Training start
2025-04-27 20:38:02,490 - node number torch.Size([13184, 12])
2025-04-27 20:38:08,181 - epoch:0, training loss:226.9156 validation loss:2.9574
2025-04-27 20:38:13,329 - epoch:1, training loss:4.1810 validation loss:3.3330
2025-04-27 20:38:18,430 - epoch:2, training loss:2.6123 validation loss:3.2839
2025-04-27 20:38:23,510 - epoch:3, training loss:2.2753 validation loss:3.4707
2025-04-27 20:38:28,692 - epoch:4, training loss:2.2257 validation loss:3.1539
2025-04-27 20:38:33,702 - epoch:5, training loss:2.1897 validation loss:2.8969
2025-04-27 20:38:38,986 - epoch:6, training loss:2.1760 validation loss:3.2855
2025-04-27 20:38:44,206 - epoch:7, training loss:2.0846 validation loss:3.5126
2025-04-27 20:38:49,354 - epoch:8, training loss:2.0675 validation loss:3.6324
2025-04-27 20:38:54,419 - epoch:9, training loss:2.0740 validation loss:3.3130
2025-04-27 20:38:59,539 - epoch:10, training loss:1.9971 validation loss:3.3274
2025-04-27 20:39:04,625 - epoch:11, training loss:2.0112 validation loss:3.1698
2025-04-27 20:39:06,225 - [*] loss:31.9199
2025-04-27 20:39:06,230 - [*] year 0, testing
2025-04-27 20:39:06,279 - T:3	MAE	5.4374	RMSE	5.5488	MAPE	14.7663
2025-04-27 20:39:06,359 - T:6	MAE	5.4308	RMSE	5.5699	MAPE	14.7168
2025-04-27 20:39:06,708 - T:12	MAE	5.4396	RMSE	5.6537	MAPE	14.6804
2025-04-27 20:39:06,708 - T:Avg	MAE	5.4363	RMSE	5.5847	MAPE	14.7247
2025-04-27 20:39:06,708 - Finished optimization, total time:44.06 s, best model:log/ENERGY-Wind/pecpm_st-100/0/2.8969.pkl
2025-04-27 20:39:06,717 - [*] Year 1 load from data/ENERGY-Wind/FastData/1.npz
2025-04-27 20:39:06,898 - [*] Year 1 Dataset load!
2025-04-27 20:39:06,899 - [*] load from log/ENERGY-Wind/pecpm_st-100/0/2.8969.pkl
2025-04-27 20:39:06,904 - PECPM initialized with backbone stgnn
2025-04-27 20:39:06,905 - [*] Year 1 Training start
2025-04-27 20:39:07,477 - node number torch.Size([14464, 12])
2025-04-27 20:39:13,369 - epoch:0, training loss:15.3047 validation loss:1.3827
2025-04-27 20:39:19,206 - epoch:1, training loss:2.1786 validation loss:1.1415
2025-04-27 20:39:24,846 - epoch:2, training loss:2.0019 validation loss:1.1207
2025-04-27 20:39:30,420 - epoch:3, training loss:1.9724 validation loss:0.9710
2025-04-27 20:39:35,959 - epoch:4, training loss:1.9590 validation loss:1.1552
2025-04-27 20:39:41,634 - epoch:5, training loss:1.9080 validation loss:1.0835
2025-04-27 20:39:47,238 - epoch:6, training loss:1.8719 validation loss:1.0236
2025-04-27 20:39:52,805 - epoch:7, training loss:1.8742 validation loss:1.0715
2025-04-27 20:39:58,433 - epoch:8, training loss:1.8375 validation loss:1.0696
2025-04-27 20:40:04,074 - epoch:9, training loss:1.8306 validation loss:0.9625
2025-04-27 20:40:09,826 - epoch:10, training loss:1.8104 validation loss:1.0314
2025-04-27 20:40:15,531 - epoch:11, training loss:1.8353 validation loss:1.2183
2025-04-27 20:40:21,302 - epoch:12, training loss:1.8257 validation loss:0.8817
2025-04-27 20:40:26,967 - epoch:13, training loss:1.8194 validation loss:1.0586
2025-04-27 20:40:32,684 - epoch:14, training loss:1.7905 validation loss:0.9317
2025-04-27 20:40:38,825 - epoch:15, training loss:1.7787 validation loss:1.1073
2025-04-27 20:40:44,754 - epoch:16, training loss:1.9480 validation loss:1.1303
2025-04-27 20:40:50,657 - epoch:17, training loss:1.8109 validation loss:0.8644
2025-04-27 20:40:56,511 - epoch:18, training loss:1.8158 validation loss:1.0170
2025-04-27 20:41:02,163 - epoch:19, training loss:1.7785 validation loss:1.1217
2025-04-27 20:41:07,897 - epoch:20, training loss:1.7882 validation loss:1.0450
2025-04-27 20:41:13,666 - epoch:21, training loss:1.7584 validation loss:1.3608
2025-04-27 20:41:19,375 - epoch:22, training loss:1.8076 validation loss:1.0441
2025-04-27 20:41:25,123 - epoch:23, training loss:1.7931 validation loss:1.5889
2025-04-27 20:41:26,908 - [*] loss:4.9476
2025-04-27 20:41:26,913 - [*] year 1, testing
2025-04-27 20:41:26,980 - T:3	MAE	1.7444	RMSE	1.8660	MAPE	4.8428
2025-04-27 20:41:27,076 - T:6	MAE	1.7856	RMSE	1.9654	MAPE	4.9865
2025-04-27 20:41:27,435 - T:12	MAE	1.9290	RMSE	2.2206	MAPE	5.4457
2025-04-27 20:41:27,435 - T:Avg	MAE	1.8100	RMSE	1.9996	MAPE	5.0605
2025-04-27 20:41:27,435 - Finished optimization, total time:97.22 s, best model:log/ENERGY-Wind/pecpm_st-100/1/0.8644.pkl
2025-04-27 20:41:27,445 - [*] Year 2 load from data/ENERGY-Wind/FastData/2.npz
2025-04-27 20:41:27,630 - [*] Year 2 Dataset load!
2025-04-27 20:41:27,632 - [*] load from log/ENERGY-Wind/pecpm_st-100/1/0.8644.pkl
2025-04-27 20:41:27,639 - PECPM initialized with backbone stgnn
2025-04-27 20:41:27,641 - [*] Year 2 Training start
2025-04-27 20:41:28,322 - node number torch.Size([15616, 12])
2025-04-27 20:41:34,785 - epoch:0, training loss:8.9071 validation loss:8.6003
2025-04-27 20:41:40,752 - epoch:1, training loss:1.9153 validation loss:8.2280
2025-04-27 20:41:46,663 - epoch:2, training loss:1.8346 validation loss:7.8069
2025-04-27 20:41:52,752 - epoch:3, training loss:1.8444 validation loss:8.0041
2025-04-27 20:41:58,733 - epoch:4, training loss:1.8274 validation loss:7.9106
2025-04-27 20:42:04,724 - epoch:5, training loss:1.8418 validation loss:8.1588
2025-04-27 20:42:10,656 - epoch:6, training loss:1.7718 validation loss:7.9911
2025-04-27 20:42:16,480 - epoch:7, training loss:1.8224 validation loss:8.2339
2025-04-27 20:42:22,408 - epoch:8, training loss:1.9984 validation loss:8.1186
2025-04-27 20:42:24,170 - [*] loss:59.8520
2025-04-27 20:42:24,174 - [*] year 2, testing
2025-04-27 20:42:24,244 - T:3	MAE	7.6688	RMSE	7.7619	MAPE	33.8089
2025-04-27 20:42:24,349 - T:6	MAE	7.6406	RMSE	7.7571	MAPE	33.7530
2025-04-27 20:42:24,694 - T:12	MAE	7.5920	RMSE	7.7600	MAPE	33.7012
2025-04-27 20:42:24,694 - T:Avg	MAE	7.6367	RMSE	7.7586	MAPE	33.7550
2025-04-27 20:42:24,694 - Finished optimization, total time:38.84 s, best model:log/ENERGY-Wind/pecpm_st-100/2/7.8069.pkl
2025-04-27 20:42:24,704 - [*] Year 3 load from data/ENERGY-Wind/FastData/3.npz
2025-04-27 20:42:24,908 - [*] Year 3 Dataset load!
2025-04-27 20:42:24,910 - [*] load from log/ENERGY-Wind/pecpm_st-100/2/7.8069.pkl
2025-04-27 20:42:24,916 - PECPM initialized with backbone stgnn
2025-04-27 20:42:24,917 - [*] Year 3 Training start
2025-04-27 20:42:25,589 - node number torch.Size([17152, 12])
2025-04-27 20:42:32,523 - epoch:0, training loss:18.1375 validation loss:6.7289
2025-04-27 20:42:38,924 - epoch:1, training loss:2.4157 validation loss:6.7465
2025-04-27 20:42:45,264 - epoch:2, training loss:2.1627 validation loss:6.6652
2025-04-27 20:42:51,698 - epoch:3, training loss:2.0877 validation loss:6.6368
2025-04-27 20:42:58,247 - epoch:4, training loss:2.0163 validation loss:6.6266
2025-04-27 20:43:04,938 - epoch:5, training loss:1.9653 validation loss:6.5721
2025-04-27 20:43:11,320 - epoch:6, training loss:1.9704 validation loss:6.8227
2025-04-27 20:43:17,813 - epoch:7, training loss:1.9827 validation loss:6.7998
2025-04-27 20:43:24,210 - epoch:8, training loss:1.9532 validation loss:6.5319
2025-04-27 20:43:30,659 - epoch:9, training loss:1.9256 validation loss:6.7464
2025-04-27 20:43:37,141 - epoch:10, training loss:1.9521 validation loss:6.3960
2025-04-27 20:43:43,747 - epoch:11, training loss:1.9239 validation loss:6.3828
2025-04-27 20:43:50,418 - epoch:12, training loss:1.9097 validation loss:6.7657
2025-04-27 20:43:57,111 - epoch:13, training loss:1.8740 validation loss:6.4879
2025-04-27 20:44:03,554 - epoch:14, training loss:1.9254 validation loss:6.6550
2025-04-27 20:44:09,996 - epoch:15, training loss:1.9021 validation loss:6.7842
2025-04-27 20:44:16,394 - epoch:16, training loss:1.8720 validation loss:6.5488
2025-04-27 20:44:22,889 - epoch:17, training loss:1.8830 validation loss:6.8384
2025-04-27 20:44:24,916 - [*] loss:51.9670
2025-04-27 20:44:24,920 - [*] year 3, testing
2025-04-27 20:44:24,993 - T:3	MAE	6.8132	RMSE	7.0040	MAPE	149.9783
2025-04-27 20:44:25,111 - T:6	MAE	6.8308	RMSE	7.0857	MAPE	153.1840
2025-04-27 20:44:25,477 - T:12	MAE	6.8511	RMSE	7.2393	MAPE	159.2165
2025-04-27 20:44:25,477 - T:Avg	MAE	6.8299	RMSE	7.0972	MAPE	153.7141
2025-04-27 20:44:25,478 - Finished optimization, total time:83.03 s, best model:log/ENERGY-Wind/pecpm_st-100/3/6.3828.pkl
2025-04-27 20:44:25,479 - 


2025-04-27 20:44:25,480 - 3   	 MAE	      5.44	      1.74	      7.67	      6.81		    5.42
2025-04-27 20:44:25,480 - 3   	RMSE	      5.55	      1.87	      7.76	      7.00		    5.55
2025-04-27 20:44:25,480 - 3   	MAPE	     14.77	      4.84	     33.81	    149.98		   50.85
2025-04-27 20:44:25,480 - 6   	 MAE	      5.43	      1.79	      7.64	      6.83		    5.42
2025-04-27 20:44:25,480 - 6   	RMSE	      5.57	      1.97	      7.76	      7.09		    5.59
2025-04-27 20:44:25,480 - 6   	MAPE	     14.72	      4.99	     33.75	    153.18		   51.66
2025-04-27 20:44:25,480 - 12  	 MAE	      5.44	      1.93	      7.59	      6.85		    5.45
2025-04-27 20:44:25,480 - 12  	RMSE	      5.65	      2.22	      7.76	      7.24		    5.72
2025-04-27 20:44:25,480 - 12  	MAPE	     14.68	      5.45	     33.70	    159.22		   53.26
2025-04-27 20:44:25,481 - Avg 	 MAE	      5.44	      1.81	      7.64	      6.83		    5.43
2025-04-27 20:44:25,481 - Avg 	RMSE	      5.58	      2.00	      7.76	      7.10		    5.61
2025-04-27 20:44:25,481 - Avg 	MAPE	     14.72	      5.06	     33.76	    153.71		   51.81
2025-04-27 20:44:25,481 - year	0   	total_time	   44.0568	average_time	    3.6714	epoch	12
2025-04-27 20:44:25,481 - year	1   	total_time	   97.2242	average_time	    4.0510	epoch	24
2025-04-27 20:44:25,481 - year	2   	total_time	   38.8409	average_time	    4.3157	epoch	9
2025-04-27 20:44:25,481 - year	3   	total_time	   83.0306	average_time	    4.6128	epoch	18
2025-04-27 20:44:25,481 - total time: 263.1525
