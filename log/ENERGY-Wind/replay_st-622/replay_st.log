2025-04-27 18:53:30,142 - logger name:log/ENERGY-Wind/replay_st-622/replay_st.log
2025-04-27 18:53:30,142 - params : {'conf': 'conf/ENERGY-Wind/replay.json', 'seed': 622, 'paral': 0, 'backbone_type': 'stgnn', 'gpuid': 2, 'logname': 'replay_st', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': '/home/haoyu.zhang/MoE_GNN/new/code/log/AIR/stlora_T-24/2016/21.3875.pkl', 'device': device(type='cuda', index=2), 'methods': {'PECPM': <class 'src.model.model.PECPM_Model'>, 'ST-Adapter': <class 'src.model.model.STAdapter_Model'>, 'GraphPro': <class 'src.model.model.GraphPro_Model'>, 'RAGraph': <class 'src.model.model.RAGraph_Model'>, 'STGNN_Model': <class 'src.model.model.STGNN_Model'>, 'ASTGNN_Model': <class 'src.model.model.ASTGNN_Model'>, 'DCRNN_Model': <class 'src.model.model.DCRNN_Model'>, 'TGCN_Model': <class 'src.model.model.TGCN_Model'>, 'STLoRA': <class 'src.model.model.STLora_Model'>, 'RAP': <class 'src.model.model.RAP_Model'>, 'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>}, 'begin_year': 0, 'end_year': 3, 'dropout': 0.0, 'lr': 0.03, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': 'data/ENERGY-Wind/RawData/', 'save_data_path': 'data/ENERGY-Wind/FastData/', 'graph_path': 'data/ENERGY-Wind/graph/', 'model_path': 'log/ENERGY-Wind/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': False, 'detect_strategy': 'feature', 'ewc': False, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'inforeplay', 'path': 'log/ENERGY-Wind/replay_st-622', 'logger': <Logger utils.initialize (INFO)>}
2025-04-27 18:53:30,156 - [*] Year 0 load from data/ENERGY-Wind/FastData/0.npz
2025-04-27 18:53:30,632 - [*] Year 0 Dataset load!
2025-04-27 18:53:30,635 - [*] Year 0 Training start
2025-04-27 18:53:30,955 - node number torch.Size([13184, 12])
2025-04-27 18:53:32,210 - epoch:0, training loss:159.0935 validation loss:4.0373
2025-04-27 18:53:33,597 - epoch:1, training loss:4.5645 validation loss:3.0058
2025-04-27 18:53:35,000 - epoch:2, training loss:2.8883 validation loss:3.1767
2025-04-27 18:53:36,441 - epoch:3, training loss:2.5437 validation loss:3.4735
2025-04-27 18:53:37,846 - epoch:4, training loss:2.3660 validation loss:3.3305
2025-04-27 18:53:39,247 - epoch:5, training loss:2.2076 validation loss:3.1783
2025-04-27 18:53:40,696 - epoch:6, training loss:2.1160 validation loss:3.3866
2025-04-27 18:53:42,090 - epoch:7, training loss:2.0848 validation loss:3.6188
2025-04-27 18:53:42,728 - [*] loss:33.6749
2025-04-27 18:53:42,737 - [*] year 0, testing
2025-04-27 18:53:42,800 - T:3	MAE	5.4772	RMSE	5.6311	MAPE	14.7622
2025-04-27 18:53:42,931 - T:6	MAE	5.5267	RMSE	5.7102	MAPE	14.8765
2025-04-27 18:53:43,330 - T:12	MAE	5.5298	RMSE	5.7927	MAPE	14.8589
2025-04-27 18:53:43,330 - T:Avg	MAE	5.5166	RMSE	5.7104	MAPE	14.8505
2025-04-27 18:53:43,331 - Finished optimization, total time:7.00 s, best model:log/ENERGY-Wind/replay_st-622/0/3.0058.pkl
2025-04-27 18:53:43,339 - [*] Year 1 load from data/ENERGY-Wind/FastData/1.npz
2025-04-27 18:53:43,343 - [*] load from log/ENERGY-Wind/replay_st-622/0/3.0058.pkl
2025-04-27 18:53:44,771 - number of increase nodes:15, nodes after 2 hop:torch.Size([67]), total nodes this year 113
2025-04-27 18:53:45,001 - [*] Year 1 Dataset load!
2025-04-27 18:53:45,002 - [*] load from log/ENERGY-Wind/replay_st-622/0/3.0058.pkl
2025-04-27 18:53:45,008 - [*] Year 1 Training start
2025-04-27 18:53:45,480 - node number torch.Size([8576, 12])
2025-04-27 18:53:46,835 - epoch:0, training loss:19.0426 validation loss:1.3103
2025-04-27 18:53:48,547 - epoch:1, training loss:2.2317 validation loss:1.2286
2025-04-27 18:53:50,253 - epoch:2, training loss:1.8576 validation loss:1.0249
2025-04-27 18:53:51,958 - epoch:3, training loss:1.7505 validation loss:1.1007
2025-04-27 18:53:53,623 - epoch:4, training loss:1.7026 validation loss:1.0081
2025-04-27 18:53:55,359 - epoch:5, training loss:1.6824 validation loss:1.0540
2025-04-27 18:53:57,080 - epoch:6, training loss:1.5885 validation loss:1.1704
2025-04-27 18:53:58,813 - epoch:7, training loss:1.5870 validation loss:1.0249
2025-04-27 18:54:00,547 - epoch:8, training loss:1.5474 validation loss:0.9366
2025-04-27 18:54:02,248 - epoch:9, training loss:1.6124 validation loss:1.0677
2025-04-27 18:54:03,965 - epoch:10, training loss:1.5612 validation loss:1.0461
2025-04-27 18:54:05,652 - epoch:11, training loss:1.5633 validation loss:0.9596
2025-04-27 18:54:07,320 - epoch:12, training loss:1.6017 validation loss:1.0331
2025-04-27 18:54:09,046 - epoch:13, training loss:1.5716 validation loss:1.1206
2025-04-27 18:54:10,715 - epoch:14, training loss:1.5290 validation loss:1.2318
2025-04-27 18:54:11,393 - [*] loss:5.6260
2025-04-27 18:54:11,406 - [*] year 1, testing
2025-04-27 18:54:11,464 - T:3	MAE	2.0693	RMSE	2.2055	MAPE	5.7526
2025-04-27 18:54:11,555 - T:6	MAE	2.0525	RMSE	2.2343	MAPE	5.7213
2025-04-27 18:54:11,839 - T:12	MAE	2.0985	RMSE	2.3814	MAPE	5.8846
2025-04-27 18:54:11,840 - T:Avg	MAE	2.0702	RMSE	2.2644	MAPE	5.7733
2025-04-27 18:54:11,840 - Finished optimization, total time:15.58 s, best model:log/ENERGY-Wind/replay_st-622/1/0.9366.pkl
2025-04-27 18:54:11,848 - [*] Year 2 load from data/ENERGY-Wind/FastData/2.npz
2025-04-27 18:54:11,852 - [*] load from log/ENERGY-Wind/replay_st-622/1/0.9366.pkl
2025-04-27 18:54:13,493 - number of increase nodes:15, nodes after 2 hop:torch.Size([80]), total nodes this year 122
2025-04-27 18:54:13,733 - [*] Year 2 Dataset load!
2025-04-27 18:54:13,734 - [*] load from log/ENERGY-Wind/replay_st-622/1/0.9366.pkl
2025-04-27 18:54:13,740 - [*] Year 2 Training start
2025-04-27 18:54:14,411 - node number torch.Size([10240, 12])
2025-04-27 18:54:15,609 - epoch:0, training loss:12.5978 validation loss:7.8103
2025-04-27 18:54:17,385 - epoch:1, training loss:2.2633 validation loss:7.7242
2025-04-27 18:54:19,143 - epoch:2, training loss:1.9583 validation loss:7.7608
2025-04-27 18:54:20,908 - epoch:3, training loss:1.9076 validation loss:7.6531
2025-04-27 18:54:22,684 - epoch:4, training loss:1.8832 validation loss:8.0662
2025-04-27 18:54:24,498 - epoch:5, training loss:1.8744 validation loss:7.7422
2025-04-27 18:54:26,310 - epoch:6, training loss:1.8548 validation loss:7.3981
2025-04-27 18:54:28,081 - epoch:7, training loss:1.9712 validation loss:7.9188
2025-04-27 18:54:29,841 - epoch:8, training loss:1.9862 validation loss:7.9894
2025-04-27 18:54:31,577 - epoch:9, training loss:2.2623 validation loss:7.5236
2025-04-27 18:54:33,388 - epoch:10, training loss:1.8833 validation loss:7.7729
2025-04-27 18:54:35,163 - epoch:11, training loss:1.7972 validation loss:7.9044
2025-04-27 18:54:36,934 - epoch:12, training loss:1.8456 validation loss:8.3773
2025-04-27 18:54:37,674 - [*] loss:59.8914
2025-04-27 18:54:37,685 - [*] year 2, testing
2025-04-27 18:54:37,750 - T:3	MAE	7.6322	RMSE	7.6995	MAPE	33.9348
2025-04-27 18:54:37,854 - T:6	MAE	7.6486	RMSE	7.7396	MAPE	34.0529
2025-04-27 18:54:38,155 - T:12	MAE	7.6200	RMSE	7.7659	MAPE	34.0916
2025-04-27 18:54:38,155 - T:Avg	MAE	7.6390	RMSE	7.7361	MAPE	34.0365
2025-04-27 18:54:38,156 - Finished optimization, total time:13.91 s, best model:log/ENERGY-Wind/replay_st-622/2/7.3981.pkl
2025-04-27 18:54:38,168 - [*] Year 3 load from data/ENERGY-Wind/FastData/3.npz
2025-04-27 18:54:38,172 - [*] load from log/ENERGY-Wind/replay_st-622/2/7.3981.pkl
2025-04-27 18:54:39,886 - number of increase nodes:18, nodes after 2 hop:torch.Size([116]), total nodes this year 134
2025-04-27 18:54:40,156 - [*] Year 3 Dataset load!
2025-04-27 18:54:40,157 - [*] load from log/ENERGY-Wind/replay_st-622/2/7.3981.pkl
2025-04-27 18:54:40,163 - [*] Year 3 Training start
2025-04-27 18:54:40,721 - node number torch.Size([14848, 12])
2025-04-27 18:54:41,961 - epoch:0, training loss:22.6964 validation loss:6.5211
2025-04-27 18:54:43,772 - epoch:1, training loss:2.9223 validation loss:6.1898
2025-04-27 18:54:45,574 - epoch:2, training loss:2.3856 validation loss:6.2773
2025-04-27 18:54:47,323 - epoch:3, training loss:2.1637 validation loss:6.3903
2025-04-27 18:54:49,113 - epoch:4, training loss:2.0511 validation loss:6.3532
2025-04-27 18:54:51,068 - epoch:5, training loss:2.0017 validation loss:6.3355
2025-04-27 18:54:52,837 - epoch:6, training loss:1.9685 validation loss:6.2432
2025-04-27 18:54:54,624 - epoch:7, training loss:1.9516 validation loss:6.4391
2025-04-27 18:54:55,347 - [*] loss:56.5847
2025-04-27 18:54:55,363 - [*] year 3, testing
2025-04-27 18:54:55,429 - T:3	MAE	7.1203	RMSE	7.3579	MAPE	162.7458
2025-04-27 18:54:55,544 - T:6	MAE	7.1066	RMSE	7.4147	MAPE	165.3471
2025-04-27 18:54:55,884 - T:12	MAE	7.1042	RMSE	7.5464	MAPE	171.9854
2025-04-27 18:54:55,884 - T:Avg	MAE	7.1115	RMSE	7.4296	MAPE	166.1507
2025-04-27 18:54:55,884 - Finished optimization, total time:8.74 s, best model:log/ENERGY-Wind/replay_st-622/3/6.1898.pkl
2025-04-27 18:54:55,885 - 


2025-04-27 18:54:55,886 - 3   	 MAE	      5.48	      2.07	      7.63	      7.12		    5.57
2025-04-27 18:54:55,886 - 3   	RMSE	      5.63	      2.21	      7.70	      7.36		    5.72
2025-04-27 18:54:55,886 - 3   	MAPE	     14.76	      5.75	     33.93	    162.75		   54.30
2025-04-27 18:54:55,886 - 6   	 MAE	      5.53	      2.05	      7.65	      7.11		    5.58
2025-04-27 18:54:55,886 - 6   	RMSE	      5.71	      2.23	      7.74	      7.41		    5.77
2025-04-27 18:54:55,886 - 6   	MAPE	     14.88	      5.72	     34.05	    165.35		   55.00
2025-04-27 18:54:55,886 - 12  	 MAE	      5.53	      2.10	      7.62	      7.10		    5.59
2025-04-27 18:54:55,886 - 12  	RMSE	      5.79	      2.38	      7.77	      7.55		    5.87
2025-04-27 18:54:55,886 - 12  	MAPE	     14.86	      5.88	     34.09	    171.99		   56.71
2025-04-27 18:54:55,886 - Avg 	 MAE	      5.52	      2.07	      7.64	      7.11		    5.58
2025-04-27 18:54:55,886 - Avg 	RMSE	      5.71	      2.26	      7.74	      7.43		    5.79
2025-04-27 18:54:55,886 - Avg 	MAPE	     14.85	      5.77	     34.04	    166.15		   55.20
2025-04-27 18:54:55,886 - year	0   	total_time	    6.9971	average_time	    0.8747	epoch	8
2025-04-27 18:54:55,886 - year	1   	total_time	   15.5779	average_time	    1.0386	epoch	15
2025-04-27 18:54:55,886 - year	2   	total_time	   13.9116	average_time	    1.0701	epoch	13
2025-04-27 18:54:55,886 - year	3   	total_time	    8.7420	average_time	    1.0928	epoch	8
2025-04-27 18:54:55,886 - total time: 45.2286
